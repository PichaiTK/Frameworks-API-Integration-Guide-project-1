messages:
  - role: system
    content: >-
      import React, { useState, useEffect, useRef } from 'react';

      import { 
        Camera, Utensils, Plane, Monitor, Search, Star, MessageSquare, 
        ArrowRight, Menu, X, Heart, Sparkles, Bot, Loader2, Copy, Check,
        Bell, Settings, User, Home, ChevronLeft, ChevronRight, BarChart3,
        ShieldCheck, LogOut, Wallet, FileText, Play, Filter, MoreVertical,
        PieChart, TrendingUp, Lock
      } from 'lucide-react';


      // --- Configuration ---

      const APP_NAME = "DesignConnect";

      // API Key จะถูกจัดการโดย environment runtime

      const apiKey = ""; 


      // --- Components ---


      // 1. Sidebar Component (เมนูด้านข้างพับเก็บได้)

      const Sidebar = ({ isOpen, toggleSidebar, activeTab, setActiveTab }) => {
        const menuItems = [
          { id: 'home', label: 'หน้าแรก', icon: <Home size={20} /> },
          { id: 'search', label: 'ค้นหาบริการ', icon: <Search size={20} /> },
          { id: 'dashboard', label: 'แดชบอร์ด (POS)', icon: <BarChart3 size={20} /> },
          { id: 'messages', label: 'ข้อความ', icon: <MessageSquare size={20} /> },
          { id: 'profile', label: 'บัญชีผู้ใช้', icon: <User size={20} /> },
          { id: 'settings', label: 'การตั้งค่า', icon: <Settings size={20} /> },
        ];

        return (
          <>
            {/* Mobile Overlay */}
            <div 
              className={`fixed inset-0 bg-black/50 z-40 lg:hidden transition-opacity ${isOpen ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}
              onClick={toggleSidebar}
            />
            
            {/* Sidebar Content */}
            <aside className={`fixed top-0 left-0 z-50 h-screen transition-all duration-300 bg-white border-r border-gray-200 w-64 shadow-xl lg:shadow-none ${isOpen ? 'translate-x-0' : '-translate-x-64'}`}>
              <div className="h-full flex flex-col">
                {/* Logo Area */}
                <div className="h-16 flex items-center px-6 border-b border-gray-100 bg-gradient-to-r from-indigo-600 to-indigo-700 text-white">
                  <div className="flex items-center gap-2">
                    <Camera size={20} className="text-white" />
                    <span className="font-bold text-lg tracking-tight">{APP_NAME}</span>
                  </div>
                  <button onClick={toggleSidebar} className="ml-auto lg:hidden text-white/80 hover:text-white">
                    <X size={20} />
                  </button>
                </div>
                
                {/* Menu Items */}
                <div className="flex-1 overflow-y-auto py-4 px-3 space-y-1">
                  {menuItems.map((item) => (
                    <button 
                      key={item.id}
                      onClick={() => { setActiveTab(item.id); if(window.innerWidth < 1024) toggleSidebar(); }}
                      className={`flex items-center w-full p-3 rounded-xl transition-all duration-200 group ${
                        activeTab === item.id 
                          ? 'bg-indigo-50 text-indigo-700 font-semibold shadow-sm ring-1 ring-indigo-200' 
                          : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'
                      }`}
                    >
                      <div className={`${activeTab === item.id ? 'text-indigo-600' : 'text-gray-400 group-hover:text-gray-600'}`}>
                        {item.icon}
                      </div>
                      <span className="ml-3">{item.label}</span>
                      {item.id === 'messages' && <span className="ml-auto bg-rose-500 text-white text-[10px] px-2 py-0.5 rounded-full font-bold shadow-sm">3</span>}
                    </button>
                  ))}
                </div>

                {/* Footer / User Info */}
                <div className="p-4 border-t border-gray-100 bg-gray-50/50">
                   <div className="flex items-center gap-3 mb-4 p-3 bg-white rounded-lg border border-indigo-100 shadow-sm">
                     <div className="bg-green-100 p-2 rounded-full">
                       <ShieldCheck size={20} className="text-green-600" />
                     </div>
                     <div>
                       <p className="text-xs font-bold text-gray-900">ระบบปลอดภัย</p>
                       <p className="text-[10px] text-gray-500">เข้ารหัส SSL 256-bit</p>
                     </div>
                   </div>
                   <button className="flex items-center justify-center w-full p-2 text-gray-700 rounded-lg hover:bg-rose-50 hover:text-rose-600 transition-colors text-sm font-medium border border-transparent hover:border-rose-100">
                    <LogOut size={16} className="mr-2" />
                    ออกจากระบบ
                  </button>
                </div>
              </div>
            </aside>
          </>
        );
      };


      // 2. TopBar Component (แถบเมนูด้านบน + แจ้งเตือน)

      const TopBar = ({ toggleSidebar, setShowAuth, isLoggedIn, user,
      toggleNotifications, showNotifications, notifications, activeTab }) => {
        return (
          <nav className="fixed top-0 left-0 right-0 z-30 bg-white/90 backdrop-blur-md border-b border-gray-200 h-16 transition-all duration-300 shadow-sm">
            <div className="h-full px-4 lg:px-6 flex items-center justify-between">
              {/* Left Side: Toggle & Title */}
              <div className="flex items-center gap-4">
                <button 
                  onClick={toggleSidebar} 
                  className="p-2 text-gray-600 rounded-lg hover:bg-gray-100 lg:hidden"
                >
                  <Menu size={24} />
                </button>
                <button 
                   onClick={toggleSidebar}
                   className="hidden lg:block p-2 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors"
                >
                  <Menu size={20} />
                </button>
                
                <span className="text-lg font-bold text-gray-800 hidden sm:block">
                  {activeTab === 'dashboard' ? 'ระบบจัดการหลังบ้าน (POS)' : 'ศูนย์รวมนักออกแบบ'}
                </span>
                
                {/* Search Bar (Desktop) - Only show on non-dashboard pages */}
                {activeTab !== 'dashboard' && (
                  <div className="hidden md:flex items-center relative w-64 lg:w-96 transition-all focus-within:w-full max-w-md ml-4">
                    <Search size={18} className="absolute left-3 text-gray-400" />
                    <input 
                      type="text" 
                      placeholder="ค้นหาบริการ, ฟรีแลนซ์, หรือไอเดีย..." 
                      className="w-full pl-10 pr-4 py-2 bg-gray-100 border-transparent focus:bg-white focus:border-indigo-300 focus:ring-4 focus:ring-indigo-100 rounded-full text-sm transition-all outline-none"
                    />
                  </div>
                )}
              </div>

              {/* Right Side: Actions */}
              <div className="flex items-center gap-2 sm:gap-4">
                <button className="md:hidden p-2 text-gray-500 hover:bg-gray-100 rounded-full">
                  <Search size={20} />
                </button>

                {/* Notifications */}
                <div className="relative">
                  <button 
                    onClick={toggleNotifications} 
                    className={`p-2 rounded-full transition-all relative ${showNotifications ? 'bg-indigo-100 text-indigo-600' : 'text-gray-500 hover:bg-gray-100'}`}
                  >
                    <Bell size={20} />
                    {notifications.some(n => !n.read) && (
                      <span className="absolute top-1.5 right-2 w-2 h-2 bg-rose-500 rounded-full border border-white animate-pulse"></span>
                    )}
                  </button>
                  
                  {/* Notification Dropdown */}
                  {showNotifications && (
                      <div className="absolute right-0 mt-3 w-80 bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden animate-in fade-in slide-in-from-top-2 z-50 ring-1 ring-black/5">
                          <div className="px-4 py-3 border-b border-gray-50 flex justify-between items-center bg-gray-50/50">
                              <span className="font-semibold text-gray-900 text-sm">การแจ้งเตือน</span>
                              <span className="text-xs text-indigo-600 cursor-pointer hover:underline font-medium">อ่านทั้งหมด</span>
                          </div>
                          <div className="max-h-[320px] overflow-y-auto">
                              {notifications.map((notif) => (
                                <div key={notif.id} className={`px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-50 last:border-0 transition-colors flex gap-3 ${!notif.read ? 'bg-indigo-50/40' : ''}`}>
                                    <div className={`mt-1.5 min-w-[8px] h-2 rounded-full ${!notif.read ? 'bg-indigo-500' : 'bg-transparent'}`} />
                                    <div>
                                      <p className="text-sm font-semibold text-gray-800">{notif.title}</p>
                                      <p className="text-xs text-gray-500 mt-0.5 line-clamp-2 leading-relaxed">{notif.desc}</p>
                                      <p className="text-[10px] text-gray-400 mt-1 font-medium">{notif.time}</p>
                                    </div>
                                </div>
                              ))}
                          </div>
                      </div>
                  )}
                </div>

                <div className="h-8 w-px bg-gray-200 hidden sm:block"></div>
                
                {isLoggedIn ? (
                  <div className="flex items-center gap-3 cursor-pointer hover:bg-gray-50 p-1 rounded-full pr-3 border border-transparent hover:border-gray-200 transition-all group">
                    <div className="relative">
                      <img className="w-9 h-9 rounded-full object-cover border-2 border-white shadow-sm group-hover:border-indigo-200 transition-colors" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&q=80&w=100" alt="user" />
                      <div className="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 border-2 border-white rounded-full"></div>
                    </div>
                    <div className="hidden md:block text-left">
                      <p className="text-sm font-semibold text-gray-700 group-hover:text-indigo-700 leading-tight">{user.name}</p>
                      <p className="text-[10px] text-gray-500 font-medium bg-gray-100 px-1.5 rounded inline-block mt-0.5">Admin</p>
                    </div>
                  </div>
                ) : (
                  <button 
                    onClick={() => setShowAuth(true)} 
                    className="bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-medium px-5 py-2 rounded-full shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5"
                  >
                    เข้าสู่ระบบ
                  </button>
                )}
              </div>
            </div>
          </nav>
        );
      };


      // 3. AdCarousel Component (แถบโฆษณา)

      const AdCarousel = () => {
          const slides = [
              {
                  id: 1,
                  image: "https://images.unsplash.com/photo-1600607686527-6fb886090705?auto=format&fit=crop&q=80&w=2000",
                  title: "อัปเกรดออฟฟิศในฝัน",
                  subtitle: "บริการออกแบบตกแต่งภายใน พร้อมทีมช่างมืออาชีพ",
                  tag: "Interior"
              },
              {
                  id: 2,
                  image: "https://images.unsplash.com/photo-1551288049-bebda4e38f71?auto=format&fit=crop&q=80&w=2000",
                  title: "Data Analytics Service",
                  subtitle: "วิเคราะห์ข้อมูลธุรกิจของคุณด้วย AI แม่นยำ 99%",
                  tag: "Tech Solution",
                  isVideo: true
              },
              {
                  id: 3,
                  image: "https://images.unsplash.com/photo-1414235077428-338989a2e8c0?auto=format&fit=crop&q=80&w=2000",
                  title: "Food Photography",
                  subtitle: "ถ่ายภาพเมนูอาหาร เพิ่มยอดขายเดลิเวอรี่",
                  tag: "Creative"
              }
          ];

          const [current, setCurrent] = useState(0);

          useEffect(() => {
              const timer = setInterval(() => {
                  setCurrent((prev) => (prev + 1) % slides.length);
              }, 6000);
              return () => clearInterval(timer);
          }, []);

          return (
              <div className="relative w-full h-[320px] md:h-[380px] overflow-hidden rounded-2xl shadow-lg mb-8 group bg-gray-900">
                  {slides.map((slide, index) => (
                      <div 
                          key={slide.id}
                          className={`absolute inset-0 transition-all duration-1000 ease-out ${index === current ? 'opacity-100 scale-100' : 'opacity-0 scale-105'}`}
                      >
                          <img src={slide.image} alt={slide.title} className="w-full h-full object-cover opacity-80" />
                          <div className="absolute inset-0 bg-gradient-to-r from-black/90 via-black/40 to-transparent flex flex-col justify-center pl-8 md:pl-16 pr-8">
                              <div className={`max-w-xl transform transition-all duration-700 ${index === current ? 'translate-y-0 opacity-100' : 'translate-y-10 opacity-0'}`}>
                                  <span className="inline-flex items-center gap-1.5 px-3 py-1 bg-white/20 backdrop-blur-md text-white text-xs font-bold rounded-full mb-4 border border-white/10">
                                      {slide.isVideo ? <Play size={10} className="fill-white" /> : <Star size={10} className="fill-white" />}
                                      {slide.tag}
                                  </span>
                                  <h2 className="text-3xl md:text-5xl font-bold text-white mb-3 leading-tight tracking-tight">{slide.title}</h2>
                                  <p className="text-lg text-gray-200 mb-8 font-light line-clamp-2">{slide.subtitle}</p>
                                  <button className="bg-white text-gray-900 hover:bg-indigo-50 px-6 py-2.5 rounded-full font-bold transition-all transform hover:scale-105 flex items-center gap-2 text-sm">
                                      ดูรายละเอียด <ArrowRight size={16} />
                                  </button>
                              </div>
                          </div>
                      </div>
                  ))}
                  
                  {/* Dots */}
                  <div className="absolute bottom-6 left-8 md:left-16 flex gap-2">
                      {slides.map((_, idx) => (
                          <button 
                              key={idx}
                              onClick={() => setCurrent(idx)}
                              className={`h-1.5 rounded-full transition-all duration-300 ${idx === current ? 'w-8 bg-indigo-500' : 'w-2 bg-white/40 hover:bg-white'}`}
                          />
                      ))}
                  </div>
              </div>
          );
      };


      // --- Main App Component ---


      const App = () => {
        const [isSidebarOpen, setIsSidebarOpen] = useState(window.innerWidth >= 1024);
        const [activeTab, setActiveTab] = useState('home');
        const [selectedCategory, setSelectedCategory] = useState('All');
        
        // Auth State
        const [showAuth, setShowAuth] = useState(false);
        const [isLoggedIn, setIsLoggedIn] = useState(false);
        const [authMode, setAuthMode] = useState('login');
        
        // Notifications State
        const [showNotifications, setShowNotifications] = useState(false);
        const [notifications] = useState([
          { id: 1, title: "ยืนยันการชำระเงินสำเร็จ", desc: "แพ็คเกจ Premium ได้รับการเปิดใช้งานแล้ว ขอบคุณที่ใช้บริการ", time: "2 นาทีที่แล้ว", read: false },
          { id: 2, title: "AI Assistant แนะนำงานใหม่", desc: "มี 3 นักออกแบบที่ตรงกับบรีฟของคุณ 'ร้านกาแฟสไตล์มินิมอล'", time: "1 ชั่วโมงที่แล้ว", read: false },
          { id: 3, title: "ยินดีต้อนรับสมาชิกใหม่", desc: "เริ่มต้นใช้งาน DesignConnect ได้เลยวันนี้", time: "1 วันที่แล้ว", read: true },
        ]);

        // AI State
        const [showAIModal, setShowAIModal] = useState(false);
        const [aiPrompt, setAiPrompt] = useState('');
        const [aiResult, setAiResult] = useState(null);
        const [isLoadingAI, setIsLoadingAI] = useState(false);
        const [copied, setCopied] = useState(false);

        // Mock Data
        const categories = [
          { id: 'Food', name: 'อาหาร & เครื่องดื่ม', icon: <Utensils size={24} />, color: 'bg-orange-100 text-orange-600', count: "1.2k Jobs" },
          { id: 'Travel', name: 'การท่องเที่ยว', icon: <Plane size={24} />, color: 'bg-blue-100 text-blue-600', count: "850 Jobs" },
          { id: 'Tech', name: 'เทคโนโลยี', icon: <Monitor size={24} />, color: 'bg-purple-100 text-purple-600', count: "2.4k Jobs" },
        ];

        const designers = [
          { id: 1, name: "ธนา ว.", role: "Food Photographer", category: "Food", rating: 4.9, reviews: 120, image: "https://images.unsplash.com/photo-1599566150163-29194dcaad36?auto=format&fit=crop&q=80&w=400", work: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?auto=format&fit=crop&q=80&w=800", tags: ["Menu", "Styling"], status: "Online" },
          { id: 2, name: "พิมพ์ใจ ส.", role: "UX/UI Designer", category: "Tech", rating: 5.0, reviews: 85, image: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&q=80&w=400", work: "https://images.unsplash.com/photo-1507238691740-187a5b1d37b8?auto=format&fit=crop&q=80&w=800", tags: ["App", "Web"], status: "Busy" },
          { id: 3, name: "กานต์ ก.", role: "Travel Vlogger", category: "Travel", rating: 4.8, reviews: 200, image: "https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?auto=format&fit=crop&q=80&w=400", work: "https://images.unsplash.com/photo-1476514525535-07fb3b4ae5f1?auto=format&fit=crop&q=80&w=800", tags: ["Video", "Drone"], status: "Online" },
          { id: 4, name: "ซาร่า ล.", role: "Brand Designer", category: "Food", rating: 4.9, reviews: 95, image: "https://images.unsplash.com/photo-1580489944761-15a19d654956?auto=format&fit=crop&q=80&w=400", work: "https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&q=80&w=800", tags: ["Logo", "Identity"], status: "Offline" }
        ];

        const filteredDesigners = selectedCategory === 'All' ? designers : designers.filter(d => d.category === selectedCategory);

        // AI Function with Retry Logic
        const generateCreativeBrief = async () => {
          if (!aiPrompt.trim()) return;
          setIsLoadingAI(true);
          setAiResult(null);
          setCopied(false);

          try {
            const response = await fetch(
              `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,
              {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                  contents: [{
                    parts: [{
                      text: `คุณเป็นผู้ช่วย Creative Director มืออาชีพ
                      โจทย์: "${aiPrompt}"
                      ให้ตอบกลับเป็น JSON Structure เท่านั้น (ไม่ต้องมี markdown block) ตามรูปแบบนี้:
                      {
                        "style": "ชื่อสไตล์สั้นๆ ภาษาไทย",
                        "description": "คำอธิบายบรรยากาศและอารมณ์ของงาน (2-3 ประโยค)",
                        "colors": ["#HexCode", "#HexCode", "#HexCode"],
                        "brief": "ร่าง Job Description ภาษาไทย สำหรับจ้างงาน เขียนให้น่าสนใจและดูเป็นมืออาชีพ แบ่งเป็นข้อๆ"
                      }`
                    }]
                  }],
                  generationConfig: { responseMimeType: "application/json" }
                })
              }
            );
            
            if (!response.ok) throw new Error('API Request Failed');
            
            const data = await response.json();
            const rawText = data.candidates?.[0]?.content?.parts?.[0]?.text;
            
            let resultObj;
            try {
              resultObj = JSON.parse(rawText);
            } catch (e) {
              // Fallback if JSON parsing fails but text exists
              resultObj = {
                style: "Creative Style (AI Generated)",
                description: rawText || "ไม่สามารถประมวลผลรูปแบบได้สมบูรณ์",
                colors: ["#CCCCCC", "#888888", "#333333"],
                brief: rawText
              };
            }
            setAiResult(resultObj);

          } catch (error) {
            console.error("AI Error:", error);
            // Fallback data for demo purposes when API key is missing or fails
            setAiResult({
              style: "Modern Minimalist (Demo)",
              description: "เน้นความเรียบง่าย สะอาดตา ใช้พื้นที่ว่าง (Negative Space) ให้เป็นประโยชน์ สื่อถึงความทันสมัยและเป็นมืออาชีพ เหมาะกับแบรนด์ยุคใหม่",
              colors: ["#2D3748", "#E2E8F0", "#38B2AC"],
              brief: "1. ต้องการนักออกแบบที่ถนัดสไตล์มินิมอล\n2. สามารถออกแบบโลโก้และ CI Branding ได้ครบวงจร\n3. เข้าใจเรื่องการใช้ Typography เป็นอย่างดี\n4. ส่งงานตรงเวลาและสื่อสารได้ดี"
            });
          } finally {
            setIsLoadingAI(false);
          }
        };

        return (
          <div className="min-h-screen bg-gray-50 font-sans text-gray-800">
            {/* Background Pattern */}
            <div className="fixed inset-0 z-0 pointer-events-none opacity-[0.02]" style={{backgroundImage: 'radial-gradient(#4F46E5 1px, transparent 1px)', backgroundSize: '24px 24px'}}></div>

            {/* --- UI Struct
  - role: user
    content: 'Pull out the action items from this meeting transcript: {{input}}'
model: openai/o4-mini
responseFormat: json_object
